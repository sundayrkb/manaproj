

<h2 align="right" id="notice"><%= notice %></h2>

	<h2>
	  <div align="right">
      <% if can? :manage, Project %>
        <%= link_to 'Project', projects_path, :class => 'navbar-link' %>
        <%= link_to 'Team', teams_path, :class => 'navbar-link' %>
      <%end%>
    </div>
  </h2>
<% if user_signed_in? and current_user.position == 'Admin'%>

	<h1>Developers In Action</h1>

  <table style="width:100%">   
    <thead>
      <tr>
        <th>Status</th>
      	  <% @users.map do |u| %> 
            <% if u.position == 'DevOps' %>
              <th><%=u.id%>.  Developer <%= u.name %> </th> 
            <%end%>
          <%end%>          
      </tr>
    </thead>
    <tbody>  
      <% @projects.group(:status).each do |p|%>
        <tr> 
         	<td><%= p.status %></td>       
            <% @users.collect do |u| %> 
            <% if u.position == 'DevOps' %> 
              <td>
                <% u.projects.each do |up| %> 
                  <% if up.user_ids.include? u.id and p.status == up.status %>                    
                      <ul> Project                   
                       <%=up.id%>. <%=up.name %>
                      </ul>              
                  <%end%>
                <%end%>
              </td>                
            <%end%>  
            <%end%>     
          </tr>
        <%end%>
    </tbody>
    <style> table, th, td {  border: 1px solid black;  border-collapse: collapse; }</style>
  </table>
<% elsif %>
  <h2><i>Hellow <%=current_user.name%> !</i></h2>
  <table  border="1">
    <thead>
      <tr>
        <th>Title</th>
        <th>Descripton</th>
        <th>Status</th>
      </tr>
    </thead>
    <tbody>
      <% current_user.projects.map do |p| %>
        <tr>
          <td>Project <%= p.title %></td>
          <td><%= p.description %></td>
          <td><%= p.status %></td>
        </tr>
      <%end%>
    </tbody>
  </table>
  <h3><i>  away As Admin</i></h3>
    
<% end %>

  <!--Load the AJAX API-->
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">

      // Load the Visualization API and the corechart package.
      google.charts.load('current', {'packages':['corechart']});

      // Set a callback to run when the Google Visualization API is loaded.
      google.charts.setOnLoadCallback(drawChart);

      // Callback that creates and populates a data table,
      // instantiates the pie chart, passes in the data and

      // draws it.
      function drawChart() {

        // Create the data table.
        var data = new google.visualization.DataTable();
        data.addColumn('string', 'Status');
        data.addColumn('number', 'Count');
        data.addRows([
          ['New', 5],
          ['In Progress', 3],
          ['Done', 1]
        ]);

        // Set chart options
        var options = {'title':'Developers In Action',
                       'width':400,
                       'height':300};

        // Instantiate and draw our chart, passing in some options.
        var chart = new google.visualization.PieChart(document.getElementById('chart_div'));
        chart.draw(data, options);
      }
    </script>
<div id="chart_div"></div>

  